{% extends 'courses/base.html' %}
{% load course_custom_tags %}

{% block title %}Home{% endblock %}

{% block css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

<style>
/* =======================
   GLOBAL BACKGROUND
======================= */
body {
    font-family: 'Segoe UI', sans-serif;
    overflow-x: hidden;
    position: relative;
    background: linear-gradient(120deg, #f0f4ff, #e0f2ff, #f0f9ff);
    background-size: 400% 400%;
    animation: slowGradient 25s ease infinite;
}

@keyframes slowGradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* =======================
   FLOATING BACKGROUND PARTICLES
======================= */
.bg-particle {
    position: fixed;
    width: 8px;
    height: 8px;
    background: rgba(14,165,233,0.35);
    border-radius: 50%;
    animation: particleMove 10s linear infinite;
    pointer-events: none;
    z-index: 0;
}

@keyframes particleMove {
    0%   { transform: translateY(0) translateX(0); opacity: 1; }
    50%  { transform: translateY(-160px) translateX(60px); opacity: 0.4; }
    100% { transform: translateY(0) translateX(0); opacity: 1; }
}

/* =======================
   HERO SECTION
======================= */
.hero {
    min-height: 90vh;
    display: flex;
    align-items: center;
    position: relative;
    padding: 50px 0;
}

/* Rotating background icons */
.bg-icon {
    position: absolute;
    width: 110px;
    opacity: 0.12;
    animation: rotateIcon 25s linear infinite;
    z-index: 0;
}

.bg-icon.left { top: 8%; left: 4%; }
.bg-icon.right { bottom: 8%; right: 4%; animation-direction: reverse; }

@keyframes rotateIcon {
    from { transform: rotate(0deg); }
    to   { transform: rotate(360deg); }
}

/* Hero text */
.hero-title {
    font-size: 52px;
    font-weight: 800;
    color: #0d47a1;
}

.hero-subtitle {
    font-size: 18px;
    color: #555;
    margin: 20px 0 30px;
}

.hero-btn {
    padding: 14px 36px;
    border-radius: 50px;
    background: linear-gradient(90deg,#0ea5e9,#0284c7);
    color: #fff;
    font-weight: 600;
}

/* Hero image */
.hero-img {
    max-width: 100%;
    animation: float 4s ease-in-out infinite;
    position: relative;
    z-index: 2;
}

@keyframes float {
    0%,100% { transform: translateY(0); }
    50%     { transform: translateY(-15px); }
}

/* =======================
   COURSE SECTION
======================= */
.section-title {
    font-size: 38px;
    font-weight: 800;
    color: #0d47a1;
}

.course-card {
    border-radius: 20px;
    background: #fff;
    overflow: hidden;
    box-shadow: 0 20px 40px rgba(0,0,0,0.08);
    transition: 0.4s;
}

.course-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 25px 50px rgba(0,0,0,0.15);
}

.course-card img {
    height: 200px;
    object-fit: cover;
}

/* Course buttons */
.course-btn {
    border-radius: 30px;
    font-weight: 600;
    transition: 0.3s;
}

.course-btn:hover {
    transform: translateY(-2px);
}

/* Scroll animation */
.animate-card {
    opacity: 0;
    transform: translateY(20px);
    transition: 0.8s;
}

.animate-card.show {
    opacity: 1;
    transform: translateY(0);
}

/* =======================
   MOUSE FOLLOW PARTICLES
======================= */
.mouse-particle {
    position: fixed;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: rgba(14,165,233,0.45);
    pointer-events: none;
    z-index: 9999;
    animation: fadeOut 1s linear forwards;
}

@keyframes fadeOut {
    to { opacity: 0; transform: scale(2); }
}

/* =======================
   MOBILE HERO FIX (ONLY)
======================= */
@media (max-width: 767px) {

    .hero {
        text-align: center;
    }

    .hero-title {
        font-size: 38px;
    }

    .hero-subtitle {
        font-size: 16px;
        margin-bottom: 24px;
    }

    .hero-btn {
        display: inline-block;
        margin-bottom: 40px;
    }

    .hero-img {
        margin-top: 20px;
    }
}
</style>
{% endblock %}

{% block js %}
<script>
/* Scroll animation */
window.addEventListener('scroll', () => {
    document.querySelectorAll('.animate-card').forEach(card => {
        if (card.getBoundingClientRect().top < window.innerHeight * 0.85) {
            card.classList.add('show');
        }
    });
});

/* Background particles */
for (let i = 0; i < 35; i++) {
    const p = document.createElement('div');
    p.className = 'bg-particle';
    p.style.top = Math.random() * 100 + '%';
    p.style.left = Math.random() * 100 + '%';
    p.style.width = Math.random() * 6 + 4 + 'px';
    p.style.height = p.style.width;
    p.style.animationDuration = 6 + Math.random() * 6 + 's';
    document.body.appendChild(p);
}

/* Mouse-follow */
document.addEventListener('mousemove', e => {
    const p = document.createElement('div');
    p.className = 'mouse-particle';
    p.style.left = e.clientX + 'px';
    p.style.top = e.clientY + 'px';
    document.body.appendChild(p);
    setTimeout(() => p.remove(), 1000);
});
</script>
{% endblock %}

{% block content %}

<!-- HERO -->
<div class="container hero">
    <img src="https://img.icons8.com/ios-filled/150/0000FF/calculator.png" class="bg-icon left">
    <img src="https://img.icons8.com/ios-filled/150/000000/book.png" class="bg-icon right">

    <div class="row align-items-center position-relative" style="z-index:2;">
        <div class="col-md-6 animate__animated animate__fadeInLeft">
            <h1 class="hero-title">Master Math & Logic<br>Build Your Future</h1>
            <p class="hero-subtitle">
                A friendly platform where anyone can learn math, logic and programming step-by-step.
            </p>
            <a href="#courses" class="hero-btn">Explore Courses</a>
        </div>

        <div class="col-md-6 text-center animate__animated animate__fadeInRight">
            <img src="static/images/hero1.png" class="hero-img">
        </div>
    </div>
</div>

<!-- COURSES -->
<div class="container my-5" id="courses">
    <div class="text-center mb-5">
        <h2 class="section-title">Our Popular Courses</h2>
        <p class="text-muted">Choose the right course and start learning</p>
    </div>

    <div class="row">
        {% for course in courses %}
        <div class="col-lg-4 col-md-6 mb-4 animate-card">
            <div class="course-card">
                <img src="{{ course.thumbnail.url }}" class="w-100">

                <div class="p-3">
                    <h5>{{ course.name }}</h5>
                    <p class="text-muted mb-1">Save {{ course.discount }}%</p>

                    <p>
                        <del>{{ course.price|tk }}</del>
                        {% cal_sellprice course.price course.discount as value %}
                        <span class="text-success">{{ value|tk }}</span>
                    </p>
                </div>

                <div class="p-3 pt-0">
                    {% is_enrolled request course as enrolled %}
                    {% if enrolled %}
                        <a href="/course/{{ course.slug }}" class="btn btn-success w-100 course-btn">
                            Start Course
                        </a>
                    {% else %}
                        <div class="row g-2">
                            <div class="col-6">
                                <a href="/check-out/{{ course.slug }}" class="btn btn-primary w-100 course-btn">
                                    Enroll
                                </a>
                            </div>
                            <div class="col-6">
                                <a href="/course/{{ course.slug }}" class="btn btn-outline-primary w-100 course-btn">
                                    Details
                                </a>
                            </div>
                        </div>
                    {% endif %}
                </div>

            </div>
        </div>
        {% endfor %}
    </div>
</div>

{% endblock %}
